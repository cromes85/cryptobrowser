<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cours Crypto - iOS 9</title>
<style>
    body { background-color: black; color: white; font-family: Arial; text-align: center; margin: 0; padding: 20px; }
    h1 { font-size: 36px; margin-bottom: 30px; }
    .crypto { font-size: 65px; font-weight: bold; margin: 40px 0 10px; }
    .source { font-size: 24px; color: #ccc; margin-bottom: 20px; }
    #lastUpdate { margin-top: 30px; font-size: 20px; color: #888; }
    hr { border: none; height: 2px; background: #444; margin: 20px 0; }
</style>
</head>
<body>
    <h1>Cours Crypto</h1>
    <div id="cryptoData">Chargement...</div>
    <div id="lastUpdate">Dernière synchro : en attente…</div>

<script>
function httpGet(url, callback){
    var xhr = new XMLHttpRequest();
    xhr.open("GET", url, true);
    xhr.onreadystatechange = function(){
        if (xhr.readyState === 4) {
            if (xhr.status === 200) {
                callback(null, JSON.parse(xhr.responseText));
            } else {
                callback(xhr.status);
            }
        }
    };
    xhr.send();
}

function updatePrices(){
    var container = document.getElementById("cryptoData");
    container.innerHTML = "Chargement…";

    httpGet("https://api.coingecko.com/api/v3/simple/price?ids=ripple,velo,nano&vs_currencies=usd", function(err, data){
        if (err) {
            container.innerHTML = "Erreur CoinGecko";
            return;
        }
        var xrp = data.ripple?.usd ?? "N/A";
        var velo = data.velo?.usd ?? "N/A";
        var nano = data.nano?.usd ?? "N/A";

        container.innerHTML = 
            '<div class="crypto">XRP : ' + xrp + ' USD</div><div class="source">CoinGecko</div><hr>' +
            '<div class="crypto">VELO : ' + velo + ' USD</div><div class="source">CoinGecko</div><hr>' +
            '<div class="crypto">NANO : ' + nano + ' USD</div><div class="source">CoinGecko</div>';

        document.getElementById("lastUpdate").innerText =
            "Dernière synchro : " + new Date().toLocaleDateString() + " " + new Date().toLocaleTimeString();
    });
}

updatePrices();
setInterval(updatePrices, 30000);
</script>
</body>
</html>
